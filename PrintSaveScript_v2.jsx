/*		v1.0 - Original Version	v1.1 - Fixed TrimType bug causing it to trim white pixles	v1.2 - Added functionality for IG banner thumbs, plus optimizations	v1.3 - Image saving function added and Poster support	v1.4 - Added PDF support	v1.5 - Added new functions for importing	v1.6 - Fixed error being caused during vertical banner saving	v1.7 - Fixed Poster files saving to the wrong folders	v1.8 - Added canvas resizing to badge mockup thumb	v1.9 - Fixed trim issue on vertical banners and door hangers and added light border to images for white backgrounds	v2.0 - Fixed issue with preset naming incorrectly and not removing -MASTER tag. 	*/#include "ImportFunctions.jsx"#target photoshopvar assetPath = "~/Desktop/Assets/Print/";if (documents.length != 0) {				var originalUnits = app.preferences.rulerUnits;		app.preferences.rulerUnits = Units.PIXELS;				var doc = activeDocument;		var docPath = doc.path;		var docName = getDocName(activeDocument);		if (docName.search(/-MASTER/i) != -1) docName = docName.slice(0,docName.search(/-MASTER/i));		var saved = doc.saved;				var hCardLayout = findLayers ('Landscape Card', true);		var vCardLayout = findLayers ('Portrait Card', true);		var sqCardLayout = findLayers ('Square Card', true);		var title = findLayers('title', false);		var subtitle = findLayers('subtitle',false);		try {						var dlg = new Window ('dialog', 'Print Save', [0,0,260,200]);						//var fileTypeLbl = dlg.add('panel',[20,15,111,55]);				var fileTypeLblTxt = dlg.add('statictext',[20,23,85,45],'Save Type');						var fileTypePnl = dlg.add('panel',[95,15,240,55]);						var fileTypeTxt = fileTypePnl.add('statictext',[15,6,170,30],getFileType());				var optionsPnl = dlg.add('panel',[20,65,240,105]);				var addStrokeOption = optionsPnl.add('checkbox',[38,6,150,30],'Add Border Stroke');						var buttonGrp = dlg.add('group', [10,115,250,180]);				var goBtn = buttonGrp.add('button', [0,0,240,30], 'Go'+(saved?'':' - Document not saved!'));				var cancel = buttonGrp.add('button', [0,35,240,65], 'Cancel');						goBtn.onClick = function () {				dlg.close();				if ((saved) || (!saved && confirm('The document is not saved. Would you like to continue?'))) { 					var addStroke = addStrokeOption.value;					savePrintFiles(addStroke);							} else { doc.activeHistoryState = doc.historyStates[doc.historyStates.length - 1]; }			}			cancel.onClick = function () {				dlg.close();				doc.activeHistoryState = doc.historyStates[doc.historyStates.length - 1];			}					dlg.center(); dlg.show();					} catch(e) {			alert (e);		}		function savePrintFiles(addStroke) { 			var logoHereLayers = findLayers ('YOUR LOGO HERE', true);			hide(logoHereLayers); 									if (!vCardLayout && !hCardLayout && !sqCardLayout) { 				var t = merge();				if (title) { 					hide(title); hide(subtitle);					var nt = merge();				}			} else {				hide(hCardLayout); hide(sqCardLayout);				var vCardT = merge();				hide(vCardLayout); show(hCardLayout);				var hCardT = merge();				hide(hCardLayout); show(sqCardLayout);				var sqCardT = merge();				if (title) { 					hide(sqCardLayout); show(vCardLayout);					hide(title); hide(subtitle); 					var vCardNT = merge();					hide(vCardLayout); show(hCardLayout);					var hCardNT = merge();					hide(hCardLayout); show(sqCardLayout);					var sqCardNT = merge();				}			}			deleteLayers(doc,2);			var newDoc = documents.add(1280,720,72,"tempDoc", NewDocumentMode.RGB, DocumentFill.TRANSPARENT);			app.activeDocument = doc; 						// ---- Card Layout ---- //			if (vCardT && hCardT && sqCardT && vCardNT && hCardNT && sqCardNT) {								doc.suspendHistory('Save files: Vertical Card', 'saveVCardFiles()');									function saveVCardFiles() {					show(vCardT); 					doc.trim(TrimType.TRANSPARENT);					saveImage("Images",docName+"#preset=card_portrait1","jpg");					if (title) { 						hide(vCardT); show(vCardNT); 						saveImage("Images",docName+"#preset=card_portrait2","jpg");						show(vCardT); hide(vCardNT);					}					addCropMarks();					saveImage("PDFs",docName+"#preset=card_portrait1#preset=pdf_4x6","pdf");					if (title) { 						hide(vCardT); show(vCardNT); 						saveImage("PDFs",docName+"#preset=card_portrait2#preset=pdf_4x6","pdf");						hide(vCardNT);					}				}							doc.activeHistoryState = doc.historyStates[doc.historyStates.length - 1];				doc.suspendHistory('Save files: Horizontal Card', 'saveHCardFiles()');									function saveHCardFiles() { 					show(hCardT);					doc.trim(TrimType.TRANSPARENT);					saveImage("Images",docName+"#preset=card_landscape1","jpg");					if (title) { 						hide(hCardT); show(hCardNT); 						saveImage("Images",docName+"#preset=card_landscape2","jpg");						show(hCardT); hide(hCardNT);					}					addCropMarks();					saveImage("PDFs",docName+"#preset=card_landscape1#preset=pdf_6x4","pdf");					if (title) { 						hide(hCardT); show(hCardNT); 						saveImage("PDFs",docName+"#preset=card_landscape2#preset=pdf_6x4","pdf");							hide(hCardNT);					}				}							doc.activeHistoryState = doc.historyStates[doc.historyStates.length - 2];				doc.suspendHistory('Save files: Square Card', 'saveSqCardFiles()');									function saveSqCardFiles() { 					show(sqCardT);					doc.trim(TrimType.TRANSPARENT);					saveImage("Images",docName+"#preset=card_square1","jpg");					if (title) { 						hide(sqCardT); show(sqCardNT); 						saveImage("Images",docName+"#preset=card_square2","jpg");						show(sqCardT); hide(sqCardNT);					}					addCropMarks();					saveImage("PDFs",docName+"#preset=card_square1#preset=pdf_6x6","pdf");					if (title) { 						hide(sqCardT); show(sqCardNT); 						saveImage("PDFs",docName+"#preset=card_square2#preset=pdf_6x6","pdf");						hide(sqCardNT);					}				}									doc.activeHistoryState = doc.historyStates[doc.historyStates.length - 2];								var sqCardPsdLayout = importImage(sqCardT,newDoc,'sqCardPsdLayout',290,29,454,454,false);				var sqCardPsdLayers = importImage(assetPath+"Cards/sqCardPsdLayers.png",newDoc,'sqCardPsdLayers',647,184,null,null,false);				var sqCardPsdLayoutSm = importImage(sqCardT,newDoc,'sqCardPsdLayoutSm',774,393,28,28,false);				var sqCardPsdText = importImage(assetPath+"psdText.png",newDoc,'sqCardPsdText',364,553,null,null,false);								var sqCardOrientationLayout = importImage(sqCardT,newDoc,'sqCardOrientationLayout',39,260,370,370,false);				var hCardOrientationLayout = importImage(hCardT,newDoc,'hCardOrientationLayout',435,260,514,370,false);				var vCardOrientationLayout = importImage(vCardT,newDoc,'vCardOrientationLayout',975,260,266,370,false);				var cardOrientationText = importImage(assetPath+"Cards/cardOrientationText.png",newDoc,'cardOrientationText',321,88,null,null,false);				 				var sqCardMockupMaskShape = importImage(assetPath+"Cards/sqCardMockupMaskShape.png",newDoc,'sqCardMockupMaskShape',315,35,null,null,false);				if (addStroke) if (addStroke) applyStrokeTo(sqCardMockupMaskShape);				var sqCardMockupLayout = importImage(sqCardT,newDoc,'sqCardMockupLayout',315,35,650,650,true);				sqCardMockupLayout.grouped = true;								var sqCardPreviewLayout = importImage(sqCardT,newDoc,'sqCardPreviewLayout',458,169,384,384,true);				sqCardPreviewLayout.rotate(12);				var sqCardPreviewOverlay = importImage(assetPath+"Cards/sqCardPreviewOverlay.png",newDoc,'sqCardPreviewOverlay',0,0,null,null,true);								newDoc.trim(TrimType.TRANSPARENT);				saveImage("Thumbs",docName+"#preset=card_promo","png");				newDoc.activeHistoryState = newDoc.historyStates[newDoc.historyStates.length - 2];								hide(sqCardPreviewLayout); hide(sqCardPreviewOverlay);				show(sqCardMockupMaskShape);								newDoc.trim(TrimType.TRANSPARENT);				saveImage("Thumbs",docName+"#preset=card_mockup","png");								newDoc.activeHistoryState = newDoc.historyStates[newDoc.historyStates.length - 2];								hide(sqCardMockupMaskShape);				show(cardOrientationText); show(vCardOrientationLayout); show(hCardOrientationLayout); show(sqCardOrientationLayout);								newDoc.trim(TrimType.TRANSPARENT);				saveImage("Thumbs",docName+"#preset=card_orientations","png");									newDoc.activeHistoryState = newDoc.historyStates[newDoc.historyStates.length - 2];								hide(cardOrientationText); hide(vCardOrientationLayout); hide(hCardOrientationLayout); hide(sqCardOrientationLayout);				show(sqCardPsdText); show(sqCardPsdLayoutSm); show(sqCardPsdLayers); show(sqCardPsdLayout);								newDoc.trim(TrimType.TRANSPARENT);				saveImage("Thumbs",docName+"#preset=card_psd_demo","png");			}			// ---- Postcard Layout ---- // ======= MP only			if ((doc.width == 1950 && doc.height == 1350)) {  								var hCardMockupMaskShape = importImage(assetPath+"Cards/hCardMockupMaskShape.png",newDoc,'hCardMockupMaskShape',170,35,null,null,true);				if (addStroke) applyStrokeTo(hCardMockupMaskShape);				var hCardMockupLayout = importImage(t,newDoc,'postcardLayout',169,33,942,652,true);				hCardMockupLayout.grouped = true; // .grouped = true makes it a clipping mask								//Save Files				newDoc.trim(TrimType.TRANSPARENT);				saveImage("Thumbs",docName+"#preset=card_landscape1","png"); //~~~~~~~~~~~~ I DONT KNOW WHAT THE CORRECT NAME IS FOR THIS			}			// ---- Bulletin Layout ---- //			if ((doc.width == 1650 && doc.height == 2550) || (doc.width == 4275 && doc.height == 2625) || (doc.width == 3375 && doc.height == 2625)) {				if (doc.width == 1650 && doc.height == 2550) { //--Media Pass Letter					var bulletinMockupFold = importImage(assetPath+"Bulletins/bulletinMockupFold.png",newDoc,'bulletinFold',464,40,null,null,true);					var bulletinMockupLayout = importImage(t,newDoc,'bulletinMockupLayout',457,83,374,578,true);					if (addStroke) if (addStroke) applyStrokeTo(bulletinMockupLayout);												newDoc.trim(TrimType.TRANSPARENT);					saveImage("Thumbs",docName+"#preset=bulletin_letter1","png");				}				if (doc.width == 4275 && doc.height == 2625) {  // Legal										doc.suspendHistory('Save files: Legal Bulletin', 'saveLegalBulletinFiles()');											function saveLegalBulletinFiles() {						show(t);						saveImage("Images",docName+"#preset=bulletin_legal1","jpg");						if (title) { 							hide(t); show(nt); 							saveImage("Images",docName+"#preset=bulletin_legal2","jpg");							show(t); hide(nt);						}						addCropMarks();						saveImage("PDFs",docName+"#preset=bulletin_legal1#preset=pdf_14x8","pdf");						if (title) { 							hide(t); show(nt); 							saveImage("PDFs",docName+"#preset=bulletin_legal2#preset=pdf_14x8","pdf");							hide(nt);						}					}								}				if (doc.width == 3375 && doc.height == 2625) { // Letter										doc.suspendHistory('Save files: Legal Bulletin', 'saveLetterBulletinFiles()');										function saveLetterBulletinFiles() {						show(t);						saveImage("Images",docName+"#preset=bulletin_letter1","jpg");						if (title) { 							hide(t); show(nt); 							saveImage("Images",docName+"#preset=bulletin_letter2","jpg");							show(t); hide(nt); 						}						addCropMarks();						saveImage("PDFs",docName+"#preset=bulletin_letter1#preset=pdf_11x8","pdf");						if (title) { 							hide(t); show(nt); 							saveImage("PDFs",docName+"#preset=bulletin_letter2#preset=pdf_11x8","pdf");							hide(nt);						}					}										doc.activeHistoryState = doc.historyStates[doc.historyStates.length - 1];										var bulletinPsdLayout = importImage(t,newDoc,'bulletinPsdLayout',226,28,584,454,false);					var bulletinPsdText = importImage(assetPath+"psdText.png",newDoc,'psdText',363,553,null,null,false);					var bulletinPsdLayers = importImage(assetPath+"Bulletins/bulletinPsdLayers.png",newDoc,'bulletinPsdLayers',710,184,null,null,false);					var bulletinPsdLayoutSm = importImage(t,newDoc,'bulletinPsdLayoutSm',835,395,32,24,false);										// for thumbs					activeDocument = doc;					doc.resizeCanvas(3300,2550,AnchorPosition.MIDDLECENTER);					doc.resizeCanvas(1650,doc.height,AnchorPosition.MIDDLERIGHT);					show(t);					var thumb = merge();					var bulletinMockupFold = importImage(assetPath+"Bulletins/bulletinMockupFold.png",newDoc,'bulletinFold',464,40,null,null,false);					var bulletinMockupLayout = importImage(thumb,newDoc,'bulletinMockupLayout',457,83,374,578,false);					if (addStroke) applyStrokeTo(bulletinMockupLayout);										var bulletinPreviewLayout = importImage(thumb,newDoc,'bulletinLayout',593,86,364,562,true);					bulletinPreviewLayout.rotate(9.5);					var bulletinPreviewOverlay = importImage(assetPath+"Bulletins/bulletinPreviewOverlay.png",newDoc,'bulletinDemoOverlay',0,0,null,null,true);											saveImage("Thumbs",docName+"#preset=bulletin_promo","png");											hide(bulletinPreviewLayout); hide(bulletinPreviewOverlay);					show(bulletinPsdLayout); show(bulletinPsdText); show(bulletinPsdLayers); show(bulletinPsdLayoutSm);										saveImage("Thumbs",docName+"#preset=bulletin_psd_demo","png");											hide(bulletinPsdLayout); hide(bulletinPsdText); hide(bulletinPsdLayers); hide(bulletinPsdLayoutSm);					show(bulletinMockupFold); show(bulletinMockupLayout);										newDoc.trim(TrimType.TRANSPARENT);					saveImage("Thumbs",docName+"#preset=bulletin_mockup","png");				}			}			// ---- Horizontal Banner Layout ---- //			if (doc.width == 9600 && doc.height == 4800) {								show(t);				saveImage("Images",docName+"#preset=hbanner1","jpg");				saveImage("PDFs",docName+"#preset=hbanner1#preset=pdf_8x4","pdf");				if (title) { 					hide(t); show(nt); 					saveImage("Images",docName+"#preset=hbanner2","jpg");					saveImage("PDFs",docName+"#preset=hbanner2#preset=pdf_8x4","pdf");				}								var hBannerPreviewLayout = importImage(t,newDoc,'hBannerPreviewLayout',590,93,648,325,true);				var hBannerPreviewOverlay = importImage(assetPath+"Banners/hBannerPreviewOverlay.png",newDoc,'hBannerPreviewOverlay',0,0,null,null,true);								var hBannerPsdLayout = importImage(t,newDoc,'hBannerPsdLayout',137,227,882,441,false);				var hBannerPsdLayers = importImage(assetPath+"Banners/hBannerPsdLayers.png",newDoc,'hBannerPsdLayers',778,279,null,null,false);				var hBannerPsdLayoutSm = importImage(t,newDoc,'hBannerPsdLayoutSm',891,502,46,22,false);				var hBannerPsdText = importImage(assetPath+"Banners/hBannerPsdText.png",newDoc,'hBannerPsdText',366,40,null,null,false);								var hBannerMockupMaskShape = importImage(assetPath+"Banners/hBannerMockupMaskShape.png",newDoc,'hBannerMockupMask',35,58,null,null,false);				if (addStroke) applyStrokeTo(hBannerMockupMaskShape);				var hBannerMockupLayout = importImage(t,newDoc,'hBannerLayout',35,58,1211,605,true);				hBannerMockupLayout.grouped = true; // .grouped = true makes it a clipping mask				var hBannerMockupGrommets = importImage(assetPath+"Banners/hBannerMockupGrommets.png",newDoc,'hBannerMockupGrommets',42,64,null,null,false);				saveImage("Thumbs",docName+"#preset=hbanner_promo","png");								hide(hBannerPreviewLayout); hide(hBannerPreviewOverlay);				show(hBannerPsdLayers); show(hBannerPsdLayout); show(hBannerPsdLayoutSm); show(hBannerPsdText);								newDoc.trim(TrimType.TRANSPARENT);				saveImage("Thumbs",docName+"#preset=hbanner_psd_demo","png");								newDoc.activeHistoryState = newDoc.historyStates[newDoc.historyStates.length - 2];								hide(hBannerPsdLayers); hide(hBannerPsdLayout); hide(hBannerPsdLayoutSm); hide(hBannerPsdText);				show(hBannerMockupGrommets); show(hBannerMockupMaskShape);								newDoc.trim(TrimType.TRANSPARENT);				saveImage("Thumbs",docName+"#preset=hbanner_mockup","png");			}			// ---- Vertical Banner Layout ---- //			if (doc.width == 3600 && doc.height == 9000) {  							show(t);				saveImage("Images",docName+"#preset=vbanner1","jpg");				saveImage("PDFs",docName+"#preset=vbanner1#preset=pdf_3x7","pdf");				if (title) { 					hide(t); show(nt); 					saveImage("Images",docName+"#preset=vbanner2","jpg");					saveImage("PDFs",docName+"#preset=vbanner2#preset=pdf_3x7","pdf");				}								var vBannerLayout = importImage(t,newDoc,'vBannerLayout',318,234,397,994,false);				var vBannerPsdText = importImage(assetPath+"psdText.png",newDoc,'vBannerPsdText',385,62,null,null,false);				var vBannerPsdLayers = importImage(assetPath+"Banners/vBannerPsdLayers.png",newDoc,'vBannerPsdLayers',618,284,null,null,false);				var vBannerLayoutSm = importImage(t,newDoc,'vBannerLayoutSm',759,493,11,28,false);							var vBannerMockupMaskShape = importImage(assetPath+"Banners/vBannerMockupMaskShape.png",newDoc,'vBannerMockupMaskShape',517,23,null,null,false);				if (addStroke) applyStrokeTo(vBannerMockupMaskShape);				var vBannerMockupLayout = importImage(t,newDoc,'vBannerMockupLayout',516,21,248,620,true);				vBannerMockupLayout.grouped = true; // .grouped = true makes it a clipping mask				var vBannerMockupStand = importImage(assetPath+"Banners/vBannerMockupStand.png",newDoc,'vBannerMockupStand', 503,18,null,null,false);							var vBannerPreviewLayout = importImage(t,newDoc,'vBannerPreviewLayout',796,45,251,625,true);				var vBannerPreviewOverlay = importImage(assetPath+"Banners/vBannerPreviewOverlay.png",newDoc,'vBannerPreviewOverlay',0,0,null,null,true);								//Save Files				saveImage("Thumbs",docName+"#preset=vbanner_promo","png");								hide(vBannerPreviewLayout); hide(vBannerPreviewOverlay); 				show(vBannerPsdText); show(vBannerLayout); show(vBannerLayoutSm); show(vBannerPsdLayers);								//newDoc.trim(TrimType.TRANSPARENT);				saveImage("Thumbs",docName+"#preset=vbanner_psd_demo","png");								newDoc.activeHistoryState = newDoc.historyStates[newDoc.historyStates.length - 1];								hide(vBannerPsdText); hide(vBannerLayout); hide(vBannerLayoutSm); hide(vBannerPsdLayers);				show(vBannerMockupMaskShape); show(vBannerMockupStand);								newDoc.trim(TrimType.TRANSPARENT);				saveImage("Thumbs",docName+"#preset=vbanner_mockup","png");			}						// ---- Poster Layout ---- //			if ((doc.width == 3638 && doc.height == 5438) || (doc.width == 1688 && doc.height == 2588)) {							//doc.layers[doc.layers.length-1].isBackgroundLayer = false;  //Turns off background layers.				if (doc.width == 3638 && doc.height == 5438) {										doc.suspendHistory('Save out large Poster files', 'saveLgPosterFiles()');										function saveLgPosterFiles() { 						show(t);						saveImage('Images',docName+'#preset=poster_24x36_1','jpg');						if (title) { // save no title							hide(t); show(nt);							saveImage('Images',docName+'#preset=poster_24x36_2','jpg');							show(t); hide(nt);						}						addCropMarks();						//doc.changeMode(ChangeMode.CMYK);						saveImage('PDFs',docName+'#preset=poster_24x36_1#preset=pdf_24x36','pdf'); 						if (title) {	// save no title pdf							hide(t); show(nt);							saveImage('PDFs',docName+'#preset=poster_24x36_2#preset=pdf_24x36','pdf');							hide(nt); show(t);						}					}					doc.activeHistoryState = doc.historyStates[doc.historyStates.length -1];										var vPosterPsdLayout = importImage(t,newDoc,'vPosterPsdLayout',88,21,443,678,false);					var vPosterPsdLayers = importImage(assetPath+"Posters/vPosterPsdLayers.png",newDoc,'vPosterPsdLayers',440,300,null,null,false);					var vPosterPsdLayoutSm = importImage(t,newDoc,'vPosterPsdLayoutSm',579,519,18,30,false);					var vPosterPsdText = importImage(assetPath+"Posters/vPosterPsdText.png",newDoc,'vPosterPsdText',629,122,null,null,false);									var vPosterMockupLayout = importImage(t,newDoc,'vPosterMockupLayout',444,85,392,600,false);					if (addStroke) applyStrokeTo(vPosterMockupLayout);					var vPosterMockupFrame = importImage(assetPath+"Posters/vPosterMockupFrame.png",newDoc,'vPosterMockupFrame',423,16,null,null,false);												var vPosterPreviewLayout = importImage(t,newDoc,'vPosterPreviewLayout',633,56,318,486,true);					var vPosterPreviewOverlay = importImage(assetPath+"Posters/vPosterPreviewOverlay.png",newDoc,'vPosterPreviewOverlay',0,0,null,null,true);										//Save Files					saveImage("Thumbs",docName+"#preset=poster_promo","png");										hide(vPosterPreviewLayout); hide(vPosterPreviewOverlay);					show (vPosterPsdLayout); show (vPosterPsdLayers); show (vPosterPsdLayoutSm); show (vPosterPsdText); 										newDoc.trim(TrimType.TRANSPARENT);					saveImage("Thumbs",docName+"#preset=poster_psd_demo","png");					newDoc.activeHistoryState = newDoc.historyStates[newDoc.historyStates.length - 2];										hide(vPosterPsdText); hide(vPosterPsdLayers); hide(vPosterPsdLayout); hide(vPosterPsdLayoutSm);					show(vPosterMockupLayout); show(vPosterMockupFrame);										newDoc.trim(TrimType.TRANSPARENT);					saveImage("Thumbs",docName+"#preset=poster_mockup","png");													//resize					app.activeDocument = doc;					doc.resizeImage (UnitValue(1731,'px'), UnitValue(2588,'px'), 150, ResampleMethod.BICUBIC);					doc.resizeCanvas(1688, 2588, AnchorPosition.MIDDLECENTER);					doc.trim(TrimType.TRANSPARENT);				}							if (doc.width == 1688 && doc.height == 2588) {					doc.suspendHistory('Save out small Poster files', 'saveSmPosterFiles()');					function saveSmPosterFiles() {						//save title						show(t); hide(nt);						saveImage('Images',docName+'#preset=poster_11x17_1','jpg');						if (title) {							hide(t); show(nt);							saveImage('Images',docName+'#preset=poster_11x17_2','jpg');						}						addCropMarks();						//doc.changeMode(ChangeMode.CMYK);						show(t); hide(nt);						saveImage('PDFs',docName+'#preset=poster_11x17_1#preset=pdf_11x17','pdf');						if (title) {							hide(t); show(nt);							saveImage('PDFs',docName+'#preset=poster_11x17_2#preset=pdf_11x17','pdf');						}					}				}			}			// ---- Hanger Layout ---- //			if (doc.width == 1125 && doc.height == 2625) {								doc.suspendHistory('Save files: Hanger', 'saveHangerFiles()');										function saveHangerFiles() {					show(t);					saveImage("Images",docName+"#preset=hanger1","jpg");					if (title) {						hide(t); show(nt); 						saveImage("Images",docName+"#preset=hanger2","jpg");						show(t); hide(nt);					}					addCropMarks();					saveImage("PDFs",docName+"#preset=hanger1#preset=pdf_3x8","pdf");					if (title) {						hide(t); show(nt); 						saveImage("PDFs",docName+"#preset=hanger2#preset=pdf_3x8","pdf");					}				}				doc.activeHistoryState = doc.historyStates[doc.historyStates.length - 1];								var hangerPreviewLayout = importImage(t,newDoc,'hangerPreviewLayout',444,122,214,500,true);				var hangerPreviewOverlay = importImage(assetPath+"Hangers/hangerPreviewOverlay.png",newDoc,'hangerPreviewOverlay',0,0,null,null,true);								var hangerMockupMaskShape = importImage(assetPath+"Hangers/hangerMockupMaskShape.png",newDoc,'hangerMockupMaskShap e',485,0,null,null,false);				if (addStroke) applyStrokeTo(hangerMockupMaskShape);				var hangerMockupLayout = importImage(t,newDoc,'hangerMockupLayout',485,0,310,720,true);				hangerMockupLayout.grouped = true; // .grouped = true makes it a clipping mask								var hangerPsdLayout = importImage(t,newDoc,'hangerPsdLayout',120,50,380,884,false);				var hangerPsdLayers = importImage(assetPath+"Hangers/hangerPsdLayers.png",newDoc,'hangerPsdLayers',410,335,null,null,false);				var hangerPsdLayoutSm = importImage(t,newDoc,'hangerPsdLayoutSm',550,544,12,28,false);				var hangerPsdText = importImage(assetPath+"Hangers/hangerPsdText.png",newDoc,'hangerPsdText',576,135,null,null,false);								//Save Files				saveImage("Thumbs",docName+"#preset=hanger_promo","png");				hide(hangerPreviewLayout); hide(hangerPreviewOverlay);				show(hangerMockupMaskShape);								newDoc.trim(TrimType.TRANSPARENT);				saveImage("Thumbs",docName+"#preset=hanger_mockup","png");				newDoc.activeHistoryState = newDoc.historyStates[newDoc.historyStates.length - 2];								hide(hangerMockupMaskShape);				show(hangerPsdLayout); show(hangerPsdLayers); show(hangerPsdLayoutSm); show(hangerPsdText);								//newDoc.trim(TrimType.TRANSPARENT);				saveImage("Thumbs",docName+"#preset=hanger_psd_demo","png");							}			// ---- Lanyard Layout ---- //			if (doc.width == 1125 && doc.height == 1725) {						doc.suspendHistory('Save files: Hanger', 'saveLanyardFiles()');								function saveLanyardFiles() {				show(t);				saveImage("Images",docName+"#preset=lanyard1","jpg");				if (title) {					hide(t); show(nt); 					saveImage("Images",docName+"#preset=lanyard2","jpg");					show(t); hide(nt); 				}				addCropMarks();				saveImage("PDFs",docName+"#preset=lanyard1#preset=pdf_3x5","pdf");				if (title) {					hide(t); show(nt); 					saveImage("PDFs",docName+"#preset=lanyard2#preset=pdf_3x5","pdf");				}			}			doc.activeHistoryState = doc.historyStates[doc.historyStates.length - 1];						var lanyardPreviewLayout = importImage(t,newDoc,'lanyardPreviewLayout',495,277,194,299,true);			var lanyardPreviewOverlay = importImage(assetPath+"Lanyards/lanyardPreviewOverlay.png",newDoc,'lanyardPreviewOverlay',0,0,null,null,true);			lanyardPreviewLayout.rotate(7);						var lanyardMockupMaskShape = importImage(assetPath+"Lanyards/lanyardMockupMaskShape.png",newDoc,'lanyardMockupMaskShape',450,118,null,null,false);			if (addStroke) applyStrokeTo(lanyardMockupMaskShape);			var lanyardMockupLayout = importImage(t,newDoc,'lanyardMockupLayout',449,116,382,588,true);			lanyardMockupLayout.grouped = true; // .grouped = true makes it a clipping mask			var lanyardMockupString = importImage(assetPath+"Lanyards/lanyardMockupString.png",newDoc,'lanyardMockupString',618,17,null,null,false);						var lanyardPsdLayout = importImage(t,newDoc,'lanyardPsdLayout',100,40,407,625,false);			var lanyardPsdLayers = importImage(assetPath+"Lanyards/lanyardPsdLayers.png",newDoc,'lanyardPsdLayers',410,240,null,null,false);			var lanyardPsdLayoutSm = importImage(t,newDoc,'lanyardPsdLayoutSm',569,507,23,36,false);			var lanyardPsdText = importImage(assetPath+"Lanyards/lanyardPsdText.png",newDoc,'lanyardPsdText',670,100,null,null,false);						//Save Files			saveImage("Thumbs",docName+"#preset=lanyard_promo","png");			hide(lanyardPreviewLayout); hide(lanyardPreviewOverlay);			show(lanyardMockupMaskShape); show(lanyardMockupString);						newDoc.trim(TrimType.TRANSPARENT);			newDoc.resizeCanvas(newDoc.width+174,newDoc.height,AnchorPosition.MIDDLERIGHT);			saveImage("Thumbs",docName+"#preset=lanyard_mockup","png");			newDoc.activeHistoryState = newDoc.historyStates[newDoc.historyStates.length - 3];						hide(lanyardMockupMaskShape); hide(lanyardMockupString);			show(lanyardPsdLayout); show(lanyardPsdLayers); show(lanyardPsdLayoutSm); show(lanyardPsdText);						newDoc.trim(TrimType.TRANSPARENT);			saveImage("Thumbs",docName+"#preset=lanyard_psd_demo","png");					}		preferences.rulerUnits = originalUnits;		newDoc.close(SaveOptions.DONOTSAVECHANGES); 		doc.close(SaveOptions.DONOTSAVECHANGES); 	} //savePrintFiles()} // open docsfunction getFileType() {	var hCardLayout = findLayers ('Landscape Card', true);	var vCardLayout = findLayers ('Portrait Card', true);	var sqCardLayout = findLayers ('Square Card', true);		if (hCardLayout && vCardLayout && sqCardLayout) return "Cards";	if (doc.width == 1950 && doc.height == 1350) return "Postcard";	if ((doc.width == 1650 && doc.height == 2550) || (doc.width == 4275 && doc.height == 2625) || (doc.width == 3375 && doc.height == 2625)) return "Bulletin";	if (doc.width == 9600 && doc.height == 4800) return "Horizontal Banner";	if (doc.width == 3600 && doc.height == 9000) return "Vertical Banner";	if ((doc.width == 3638 && doc.height == 5438) || (doc.width == 1688 && doc.height == 2588)) return "Poster";	if (doc.width == 1125 && doc.height == 2625) return "Hanger";	if (doc.width == 1125 && doc.height == 1725) return "Lanyard";}function applyStrokeTo(target) {	activeDocument.activeLayer = target;	var idsetd = charIDToTypeID( "setd" );		var desc28 = new ActionDescriptor();		var idnull = charIDToTypeID( "null" );			var ref9 = new ActionReference();			var idPrpr = charIDToTypeID( "Prpr" );			var idLefx = charIDToTypeID( "Lefx" );			ref9.putProperty( idPrpr, idLefx );			var idLyr = charIDToTypeID( "Lyr " );			var idOrdn = charIDToTypeID( "Ordn" );			var idTrgt = charIDToTypeID( "Trgt" );			ref9.putEnumerated( idLyr, idOrdn, idTrgt );		desc28.putReference( idnull, ref9 );		var idT = charIDToTypeID( "T   " );			var desc29 = new ActionDescriptor();			var idScl = charIDToTypeID( "Scl " );			var idPrc = charIDToTypeID( "#Prc" );			desc29.putUnitDouble( idScl, idPrc, 100.000000 );			var idIrSh = charIDToTypeID( "IrSh" );				var desc30 = new ActionDescriptor();				var idenab = charIDToTypeID( "enab" );				desc30.putBoolean( idenab, true );				var idpresent = stringIDToTypeID( "present" );				desc30.putBoolean( idpresent, true );				var idshowInDialog = stringIDToTypeID( "showInDialog" );				desc30.putBoolean( idshowInDialog, true );				var idMd = charIDToTypeID( "Md  " );				var idBlnM = charIDToTypeID( "BlnM" );				var idNrml = charIDToTypeID( "Nrml" );				desc30.putEnumerated( idMd, idBlnM, idNrml );				var idClr = charIDToTypeID( "Clr " );					var desc31 = new ActionDescriptor();					var idRd = charIDToTypeID( "Rd  " );					desc31.putDouble( idRd, 0.000000 );					var idGrn = charIDToTypeID( "Grn " );					desc31.putDouble( idGrn, 0.000000 );					var idBl = charIDToTypeID( "Bl  " );					desc31.putDouble( idBl, 0.000000 );				var idRGBC = charIDToTypeID( "RGBC" );				desc30.putObject( idClr, idRGBC, desc31 );				var idOpct = charIDToTypeID( "Opct" );				var idPrc = charIDToTypeID( "#Prc" );				desc30.putUnitDouble( idOpct, idPrc, 15.000000 );				var iduglg = charIDToTypeID( "uglg" );				desc30.putBoolean( iduglg, true );				var idlagl = charIDToTypeID( "lagl" );				var idAng = charIDToTypeID( "#Ang" );				desc30.putUnitDouble( idlagl, idAng, 120.000000 );				var idDstn = charIDToTypeID( "Dstn" );				var idPxl = charIDToTypeID( "#Pxl" );				desc30.putUnitDouble( idDstn, idPxl, 0.000000 );				var idCkmt = charIDToTypeID( "Ckmt" );				var idPxl = charIDToTypeID( "#Pxl" );				desc30.putUnitDouble( idCkmt, idPxl, 100.000000 );				var idblur = charIDToTypeID( "blur" );				var idPxl = charIDToTypeID( "#Pxl" );				desc30.putUnitDouble( idblur, idPxl, 1.000000 );				var idNose = charIDToTypeID( "Nose" );				var idPrc = charIDToTypeID( "#Prc" );				desc30.putUnitDouble( idNose, idPrc, 0.000000 );				var idAntA = charIDToTypeID( "AntA" );				desc30.putBoolean( idAntA, false );				var idTrnS = charIDToTypeID( "TrnS" );					var desc32 = new ActionDescriptor();					var idNm = charIDToTypeID( "Nm  " );					desc32.putString( idNm, """Linear""" );				var idShpC = charIDToTypeID( "ShpC" );				desc30.putObject( idTrnS, idShpC, desc32 );			var idIrSh = charIDToTypeID( "IrSh" );			desc29.putObject( idIrSh, idIrSh, desc30 );		var idLefx = charIDToTypeID( "Lefx" );		desc28.putObject( idT, idLefx, desc29 );	executeAction( idsetd, desc28, DialogModes.NO );}  